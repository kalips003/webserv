WORKING - some cleanup, global settings with friend